<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Algebra 2: Escape the Mad Scientist's Lab</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .puzzle-card {
            transition: all 0.3s ease-in-out;
            border-left: 4px solid transparent;
        }
        .puzzle-card.locked {
            filter: grayscale(80%);
            opacity: 0.6;
            pointer-events: none;
        }
        .puzzle-card.active {
            filter: grayscale(0%);
            opacity: 1;
            pointer-events: auto;
            border-left-color: #4f46e5; /* indigo-600 */
        }
        .input-field {
            transition: all 0.2s ease;
        }
        .feedback-box {
            background-color: #e0e7ff; /* indigo-100 */
            color: #3730a3; /* indigo-800 */
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8 max-w-4xl">
        <!-- Header -->
        <header class="text-center mb-8 bg-white p-6 rounded-xl shadow-md border-t-4 border-indigo-600">
            <h1 class="text-3xl md:text-4xl font-bold text-indigo-700">Escape the Mad Scientist's Lab!</h1>
            <p class="mt-2 text-lg text-gray-600">You've been trapped by a mad scientist! The only way out is to solve 5 puzzles to override the door's security code. Each puzzle reveals one digit.</p>
        </header>

        <main class="space-y-6">
            <!-- Puzzle 1: Graphing -->
            <section id="puzzle-1" class="puzzle-card active bg-white p-6 rounded-xl shadow-md">
                <div class="flex items-center mb-4">
                    <div class="bg-indigo-600 text-white rounded-full h-10 w-10 flex items-center justify-center font-bold text-xl mr-4">1</div>
                    <h2 class="text-2xl font-semibold">The Specimen Cabinet</h2>
                </div>
                <p class="mb-4">The first digit of the code is hidden in a locked specimen cabinet. The key is the **absolute value** of the **x-coordinate** of the intersection point of the two lines on the graph below. What is the digit?</p>
                <div class="flex justify-center mb-4">
                     <img src="https://placehold.co/400x300/e0e7ff/4f46e5?text=Graph+of%0Ay=x%2B3%0Aand%0Ay=-0.5x&font=inter" alt="Graph showing two intersecting lines. The lines intersect at the point (-2,1)." class="rounded-lg border">
                </div>
                <div class="flex items-center gap-4">
                    <input id="answer-1" type="number" placeholder="Enter the digit" class="input-field w-full p-3 border-2 border-gray-300 rounded-lg focus:border-indigo-500 focus:ring-indigo-500">
                    <button class="bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-indigo-700" onclick="checkAnswer(1)">Unlock</button>
                </div>
                <div id="feedback-1" class="hidden mt-4 p-4 feedback-box rounded-lg font-semibold"></div>
            </section>

            <!-- Puzzle 2: System of Equations -->
            <section id="puzzle-2" class="puzzle-card locked bg-white p-6 rounded-xl shadow-md">
                <div class="flex items-center mb-4">
                    <div class="bg-indigo-600 text-white rounded-full h-10 w-10 flex items-center justify-center font-bold text-xl mr-4">2</div>
                    <h2 class="text-2xl font-semibold">The Encrypted Hard Drive</h2>
                </div>
                <p class="mb-4">A riddle on an encrypted hard drive provides the following system of equations. The second digit of the door code is the value of **x**.</p>
                <div class="bg-gray-100 p-4 rounded-lg text-center text-lg mb-4 font-mono">
                    <p>2x + 3y = 3</p>
                    <p>5x - 2y = 17</p>
                </div>
                <div class="flex items-center gap-4">
                    <input id="answer-2" type="number" placeholder="Value of x" class="input-field w-full p-3 border-2 border-gray-300 rounded-lg focus:border-indigo-500 focus:ring-indigo-500">
                    <button class="bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-indigo-700" onclick="checkAnswer(2)">Solve</button>
                </div>
                 <div id="feedback-2" class="hidden mt-4 p-4 feedback-box rounded-lg font-semibold"></div>
            </section>

            <!-- Puzzle 3: Standard Form (Y-Intercept) -->
            <section id="puzzle-3" class="puzzle-card locked bg-white p-6 rounded-xl shadow-md">
                 <div class="flex items-center mb-4">
                    <div class="bg-indigo-600 text-white rounded-full h-10 w-10 flex items-center justify-center font-bold text-xl mr-4">3</div>
                    <h2 class="text-2xl font-semibold">The Bubbling Beakers</h2>
                </div>
                <p class="mb-4">A formula is scrawled on a rack of bubbling beakers. The third digit of the door code is the **y-intercept** of this line. Where does the line cross the y-axis?</p>
                <div class="bg-gray-100 p-4 rounded-lg text-center text-2xl mb-4 font-mono">
                    <p>6x + 7y = 63</p>
                </div>
                <div class="flex items-center gap-4">
                    <input id="answer-3" type="number" placeholder="Enter the y-intercept" class="input-field w-full p-3 border-2 border-gray-300 rounded-lg focus:border-indigo-500 focus:ring-indigo-500">
                    <button class="bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-indigo-700" onclick="checkAnswer(3)">Find</button>
                </div>
                <div id="feedback-3" class="hidden mt-4 p-4 feedback-box rounded-lg font-semibold"></div>
            </section>

            <!-- Puzzle 4: Standard Form (X-Intercept) -->
            <section id="puzzle-4" class="puzzle-card locked bg-white p-6 rounded-xl shadow-md">
                <div class="flex items-center mb-4">
                    <div class="bg-indigo-600 text-white rounded-full h-10 w-10 flex items-center justify-center font-bold text-xl mr-4">4</div>
                    <h2 class="text-2xl font-semibold">The Laser Grid Schematics</h2>
                </div>
                <p class="mb-4">A framed schematic on the wall shows a line representing a laser beam. The fourth digit of the door code is the **x-intercept** of this line. Where does the line cross the x-axis?</p>
                <div class="bg-gray-100 p-4 rounded-lg text-center text-2xl mb-4 font-mono">
                     <p>3x + 9y = 21</p>
                </div>
                <div class="flex items-center gap-4">
                    <input id="answer-4" type="number" placeholder="Enter the x-intercept" class="input-field w-full p-3 border-2 border-gray-300 rounded-lg focus:border-indigo-500 focus:ring-indigo-500">
                    <button class="bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-indigo-700" onclick="checkAnswer(4)">Calculate</button>
                </div>
                <div id="feedback-4" class="hidden mt-4 p-4 feedback-box rounded-lg font-semibold"></div>
            </section>

            <!-- Puzzle 5: Inequalities -->
            <section id="puzzle-5" class="puzzle-card locked bg-white p-6 rounded-xl shadow-md">
                <div class="flex items-center mb-4">
                    <div class="bg-indigo-600 text-white rounded-full h-10 w-10 flex items-center justify-center font-bold text-xl mr-4">5</div>
                    <h2 class="text-2xl font-semibold">The Containment Field</h2>
                </div>
                <p class="mb-4">The final clue is on a monitor, showing a "containment field". The final digit of the code is the **total number of possible integer y-values** when **x = 1**. How many integer points lie on the vertical line x=1 inside the solution area?</p>
                <div class="flex justify-center mb-4">
                    <img src="https://placehold.co/400x300/e0e7ff/4f46e5?text=Safe+Zone%0Ay+%3C%3D+-x%2B6%0Aand%0Ay+%3E+2x-3&font=inter" alt="Graph showing a shaded solution region for a system of inequalities." class="rounded-lg border">
                </div>
                <div class="flex items-center gap-4">
                    <input id="answer-5" type="number" placeholder="Enter the total number of points" class="input-field w-full p-3 border-2 border-gray-300 rounded-lg focus:border-indigo-500 focus:ring-indigo-500">
                    <button class="bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-indigo-700" onclick="checkAnswer(5)">Verify</button>
                </div>
                <div id="feedback-5" class="hidden mt-4 p-4 feedback-box rounded-lg font-semibold"></div>
            </section>

            <!-- Final Code Entry -->
            <section id="final-challenge" class="puzzle-card locked bg-white p-6 rounded-xl shadow-md">
                 <h2 class="text-2xl font-semibold text-center">The Security Keypad</h2>
                 <p class="text-center text-gray-600 mt-2 mb-4">You have all five digits. Enter the code to deactivate the security system!</p>
                 <div class="flex justify-center items-center gap-4">
                     <input id="code-input" type="text" maxlength="5" class="text-3xl tracking-[.5em] text-center font-bold border-2 border-gray-300 rounded-lg w-48 h-16 focus:border-indigo-500 focus:ring-indigo-500">
                     <button id="submit-code" class="bg-green-600 text-white font-bold py-2 px-6 rounded-lg h-16 text-lg hover:bg-green-700 transition-colors">Escape</button>
                 </div>
                 <div id="final-feedback" class="text-center mt-4"></div>
            </section>
        </main>
        
        <!-- Success Modal -->
        <div id="success-modal" class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4">
            <div class="bg-white rounded-2xl shadow-2xl p-8 text-center max-w-md w-full transform transition-all scale-95">
                <div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 mb-4">
                    <svg class="h-10 w-10 text-green-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 10.5V6.75a4.5 4.5 0 119 0v3.75M3.75 21.75h10.5a2.25 2.25 0 002.25-2.25v-6.75a2.25 2.25 0 00-2.25-2.25H3.75a2.25 2.25 0 00-2.25 2.25v6.75a2.25 2.25 0 002.25 2.25z" />
                    </svg>
                </div>
                <h3 class="text-3xl font-bold text-gray-900">You Escaped!</h3>
                <p class="mt-4 text-lg text-gray-600">Congratulations! You solved the puzzles and unlocked the door. Show this screen to your teacher for your extra credit.</p>
            </div>
        </div>
    </div>

    <script>
        const solvedPuzzles = new Set();

        function parseCoordinates(input) {
            const cleaned = input.replace(/[\s()]/g, '');
            const parts = cleaned.split(',');
            if (parts.length !== 2) return null;
            const x = parseFloat(parts[0]);
            const y = parseFloat(parts[1]);
            if (isNaN(x) || isNaN(y)) return null;
            return { x, y };
        }

        function checkAnswer(puzzleNumber) {
            if (solvedPuzzles.has(puzzleNumber)) return;

            const inputElement = document.getElementById(`answer-${puzzleNumber}`);
            const feedbackElement = document.getElementById(`feedback-${puzzleNumber}`);
            const inputValue = inputElement.value.trim();
            let isCorrect = false;
            let feedbackMessage = '';

            switch(puzzleNumber) {
                case 1:
                    if (parseFloat(inputValue) === 2) {
                        isCorrect = true;
                        feedbackMessage = "Click! The drawer opens. The first digit of the code is 2. (The x-coordinate was -2, but the key is the absolute value!)";
                    }
                    break;
                case 2:
                    if (parseFloat(inputValue) === 3) {
                        isCorrect = true;
                        feedbackMessage = "The riddle is solved! The second digit is 3.";
                    }
                    break;
                case 3:
                    if (parseFloat(inputValue) === 9) {
                        isCorrect = true;
                        feedbackMessage = "You found the clue on the desk. The third digit is 9.";
                    }
                    break;
                case 4:
                    if (parseFloat(inputValue) === 7) {
                        isCorrect = true;
                        feedbackMessage = "The blueprint reveals its secret. The fourth digit is 7.";
                    }
                    break;
                case 5:
                    if (parseFloat(inputValue) === 6) {
                        isCorrect = true;
                        feedbackMessage = "Correct! When x=1, the y-values can be 0, 1, 2, 3, 4, or 5. That's 6 possibilities. The final digit is 6.";
                    }
                    break;
            }

            if (isCorrect) {
                feedbackElement.textContent = feedbackMessage;
                feedbackElement.classList.remove('hidden');
                inputElement.classList.add('border-green-500');
                inputElement.disabled = true;
                solvedPuzzles.add(puzzleNumber);
                
                const currentPuzzle = document.getElementById(`puzzle-${puzzleNumber}`);
                currentPuzzle.classList.remove('active');
                
                const nextPuzzle = document.getElementById(`puzzle-${puzzleNumber + 1}`);
                if (nextPuzzle) {
                    nextPuzzle.classList.remove('locked');
                    nextPuzzle.classList.add('active');
                } else {
                    const finalChallenge = document.getElementById('final-challenge');
                    finalChallenge.classList.remove('locked');
                    finalChallenge.classList.add('active');
                }
            } else {
                inputElement.classList.add('border-red-500');
                setTimeout(() => inputElement.classList.remove('border-red-500'), 1500);
            }
        }

        document.getElementById('submit-code').addEventListener('click', () => {
            const finalFeedback = document.getElementById('final-feedback');
            const input = document.getElementById('code-input');
            const correctCode = '23976';

            if (input.value === correctCode) {
                document.getElementById('success-modal').classList.remove('hidden');
                setTimeout(() => document.querySelector('#success-modal > div').classList.add('scale-100'), 10);
            } else {
                finalFeedback.textContent = 'Incorrect code. The door remains locked!';
                finalFeedback.classList.add('text-red-500', 'font-semibold');
                input.classList.add('border-red-500', 'animate-shake');
                setTimeout(() => {
                    input.classList.remove('border-red-500', 'animate-shake');
                    finalFeedback.textContent = '';
                }, 2000);
            }
        });

        const style = document.createElement('style');
        style.innerHTML = `@keyframes shake { 10%, 90% { transform: translateX(-1px); } 20%, 80% { transform: translateX(2px); } 30%, 50%, 70% { transform: translateX(-4px); } 40%, 60% { transform: translateX(4px); } } .animate-shake { animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both; }`;
        document.head.appendChild(style);
    </script>
</body>
</html>


